# 🎰 Bank of Taiwan｜年終尾牙抽獎系統

這是一個純前端、無需安裝、無伺服器的年終尾牙抽獎網頁應用。特色為透明玻璃球體動畫、物理模擬、程式化音效，以及支援多獎品、可重複/不可重複中獎、CSV 上傳與匯出、**手動設定中獎名單**等功能。所有資料皆儲存在瀏覽器本地，保障隱私。

## 主要功能

### 🎯 抽獎功能
- 透明球體動畫，模擬真實樂透機滾動與碰撞
- 支援上傳員工名單（CSV）與獎品清單（CSV）
- 可設定每種獎品抽出人數，並選擇可否重複中獎
- 逐一揭曉中獎者，搭配動畫與 Web Audio API 音效

### ✋ 手動設定中獎名單
- **手動新增中獎者**：可預先指定特定員工獲得特定獎品
- **獎品名額管理**：手動設定會自動扣減對應獎品的可用數量
- **完整CRUD功能**：新增、讀取、編輯、刪除手動設定的中獎記錄
- **智能表單**：選擇員工編號後自動顯示對應姓名
- **資料驗證**：防止重複設定、名額超用等問題
- **整合顯示**：中獎名單同時顯示線上抽獎與手動設定的結果

### 📊 資料管理
- 中獎名單可一鍵匯出 CSV（包含手動設定與抽獎結果）
- 支援多種編碼（UTF-8、Big5、GBK、UTF-16LE）
- 資料儲存於 LocalStorage，重整不遺失

## 使用方式

1. 下載或 clone 本專案，直接用瀏覽器開啟 [index.html](index.html)
2. 上傳員工 CSV（格式：員工編號,姓名，第一列為標題）
3. 上傳獎品 CSV（格式：獎品種類,獎品數量，第一列為標題）

### 方案A：純線上抽獎（傳統方式）
4. 選擇獎品、設定抽出人數 N
5. 選擇「可重複中獎」或「不可重複」
6. 點擊「開始抽獎」，依序揭曉中獎者

### 方案B：手動設定 + 線上抽獎（混合方式）
4. 滾動到「手動設定中獎名單」面板
5. 點擊「➕ 新增中獎者」，手動指定特定員工獲獎
6. 系統會自動扣減該獎品的可用名額
7. 選擇獎品進行線上抽獎（只會抽剩餘名額）

### 查看與匯出
8. 在「中獎名單」查看所有中獎者（含來源標註）
9. 可匯出中獎名單 CSV，或清除/重置資料

## 操作說明：重置 vs 清除資料

- **重置（N 至 1）**：停止動畫、清空球體與結果顯示，並將抽出人數 `N` 重設為 `1`；不影響參與者、獎品、中獎紀錄與手動設定。
- **清除資料**：移除瀏覽器本地（LocalStorage）的參與者、獎品、中獎紀錄與手動設定；此時參與者數 `M=0`，抽出人數 `N=0`，需重新上傳 CSV 後方可抽獎。
 - **提示**：清除前確認視窗會告知抽出人數 `N` 將歸 `0`，需重新上傳 CSV 後才能抽獎。

## CSV 格式範例

員工名單：
```csv
員工編號,姓名
A001,王小明
A002,李小華
A003,張小美
```

獎品清單：
```csv
獎品種類,獎品數量
頭獎,1
貳獎,2
參獎,3
```

**下載範例（Big5 編碼）**
- [examples/employees.csv](examples/employees.csv)
- [examples/prizes.csv](examples/prizes.csv)

## 技術說明

- 單一檔案應用（HTML+CSS+JS）
- 物理模擬：requestAnimationFrame、碰撞反彈、摩擦、渦流
- 音效：Web Audio API 動態產生（無外部音檔）
- 視覺特效：CSS 動畫、粒子爆裂、脈衝數字
- 資料持久化：LocalStorage（含手動中獎名單）
- 手動設定中獎名單：完整CRUD功能、自動名額管理
- 無障礙支援：prefers-reduced-motion
- **響應式設計**：桌面版雙欄布局 (> 980px)、行動版單欄自適應 (≤ 980px)

## 專案結構

```
BotLottery/
├── index.html                    # 主程式
├── manifest.json                 # Web App Manifest
├── README.md                     # 說明文件
├── logo.png                      # Logo 圖片
└── examples/
    ├── employees.csv             # 員工範例檔案 (Big5 編碼)
    └── prizes.csv                # 獎品範例檔案 (Big5 編碼)
```

## 注意事項

- 首次播放音效需用戶互動（點擊「開始抽獎」）
- 所有資料僅儲存在本機，不會上傳
- 支援 Chrome/Edge/Firefox/Safari，IE 不支援
- 手動設定與線上抽獎共用獎品名額
- **最佳瀏覽體驗**：建議使用桌面版瀏覽器（> 980px），行動裝置亦完整支援

## 新功能亮點（v2.0）

### 🎯 手動設定中獎名單
想要預先指定某些員工獲得特定獎品？沒問題！

- **場景1：VIP保證獎**
  ```
  特等獎（總10名）
  ├─ 手動設定 3 名 → 董事長、總經理、特別來賓
  └─ 線上抽獎 7 名 → 現場公平抽出
  ```

- **場景2：部門保證名額**
  ```
  頭獎（總5名）
  ├─ 手動設定 1 名 → 業務部保證名額
  ├─ 手動設定 1 名 → 研發部保證名額
  └─ 線上抽獎 3 名 → 全公司抽出
  ```

### ✨ 智能名額管理
- 手動設定後，系統自動扣減可用名額
- 獎品選單顯示實際剩餘數量
- 防止超額設定與重複中獎
- 刪除手動設定會立即恢復名額

### 📊 完整資料整合
- 統一中獎名單顯示所有結果
- 清楚標註來源（抽獎/手動）
- 匯出CSV包含完整資訊
- 支援編輯與刪除功能

## 授權

版權所有 © Dunk

---

**Demo**：直接開啟 [index.html](index.html) 即可體驗
